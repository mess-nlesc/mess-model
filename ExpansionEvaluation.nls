
to ExpansionEvaluation                                                                                                ;; compare the yields of each farmer for canal expansion
  ask patches with [LandType = 3]                                                                                     ;; ask storage patch
  [
    if year > 5                                                                                                       ;; the earliest first year of continuously good/poor harvest is 5th year
    [
;; start with the good harvest to all farmers
      if ContinuouslySameHarvestYearProcedure_1year_1st? = False                                                                ;; before the 1st good harvest year
      [
;;1st year
        ;;1st year start with good harvest (good1, 1st)
        if NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
        [
          set ContinuouslySameHarvestYearProcedure_1year_1st? True                                         ;; the 1st time all farmers have the same good harvest
          ;set ContinuouslySameHarvestYear 1            
        ]       
      ]   
;2nd year
      if ContinuouslySameHarvestYearProcedure_1year_1st? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_1 (CountDownExpansion1_1 - 1)                                  ;; CountDownExpansion1 is 365, and it decreases till 0 and the ohter comparison between farmers happens
        if CountDownExpansion1_1 = 0
        [
          ;;2nd year start with good harvest (good2, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_1st? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation            
          ]
          [       
            ;;2nd year start with poor harvest (poor1, 1st)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_1st? True                                                     
              ;set ContinuouslyPoorHarvestYear 1               
            ]  
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]               
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_1st? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0 
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time               
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]           
          ]                            
        ]        
      ]
;; 3rd year
      if ContinuouslySameHarvestYearProcedure_2years_1st? = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_1 (CountDownExpansion2_1 - 1)
        if CountDownExpansion2_1 = 0
        [
          ;;3rd year start with good harvest (good3, 1st)                   
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_1st? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation             
          ]
          [
            ;;3rd year start with poor harvest (poor1, 2nd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_2nd? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                         
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_2nd? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                
            ]             
          ]         
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_1st? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_1 (CountDownMovement1_1 - 1)
        if CountDownMovement1_1 = 0
        [         
          ;; 3rd year start with poor harvest (poor2, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;; 3rd year start with good harvest (good1, 2nd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_2nd? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                         
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 2               
          ]
          [
            ;; 3rd year start with good harvest (good1, 2nd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_2nd? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                         
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]
;; 4th year
      if ContinuouslySameHarvestYearProcedure_3years_1st? = True
      [
        set ContinuouslySameHarvestYear 3
        set CountDownExpansion3_1 (CountDownExpansion3_1 - 1)
        if CountDownExpansion3_1 = 0 
        [
          ;; 4th year start with good harvest (good4, 1st)         
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_4years_1st? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 4                                                            ;; count the 3rd time of same good harvest situation              
          ]
          [
            ;; 4th year satrt with poor harvest (poor1, 3rd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_3rd? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_3rd? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                
            ]             
          ]                  
        ]  
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_2nd? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_2 (CountDownMovement1_2 - 1)
        if CountDownMovement1_2 = 0
        [          
          ;; 4th year satrt with poor harvest (poor2, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;; 4th year start with good harvest (good1, 3rd)  
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_3rd? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                  
          ]
          [
            ;; 4th year start with good harvest (good1, 3rd)  
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_3rd? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]       
      ]
      if ContinuouslySameHarvestYearProcedure_1year_2nd? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_2 (CountDownExpansion1_2 - 1)
        if CountDownExpansion1_2 = 0
        [
          ;; 4th year start with good harvest (good2, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_2nd? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation            
          ]
          [
            ;; 4th year satrt with poor harvest (poor1, 4th)  
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_4th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                        
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_4th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                      
        ]       
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_1st? = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_1 (CountDownMovement2_1 - 1)
        if CountDownMovement2_1 = 0
        [          
          ;; 4th year satrt with poor harvest (poor3, 1st)   
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                                                                            
          ]
          [
            ;; 4th year start with good harvest (good1, 4th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_4th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                  
          ]
          [
            ;; 4th year start with good harvest (good1, 4th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_4th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]       
      ]
;;5th year
      if ContinuouslySameHarvestYearProcedure_4years_1st? = True
      [
        set ContinuouslySameHarvestYear 4
        set CountDownExpansion4_1 (CountDownExpansion4_1 - 1)
        if CountDownExpansion4_1 = 0
        [
          ;; 5th year with good harvest (good5, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_5years_1st? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 5                                                            ;; count the 3rd time of same good harvest situation              
          ]
          [
            ;; 5th year with poor harvest (poor1, 5th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_5th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_5th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                 
            ]             
          ]                    
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_3rd? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_3 (CountDownMovement1_3 - 1)
        if CountDownMovement1_3 = 0
        [                    
          ;; 5th year with poor harvest (poor2, 3rd)  
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_3rd? True                                                    
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;; 5th year with good harvest (good1, 5th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_5th? True                                   
              ;set ContinuouslySameHarvestYear 1                                                                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_3rd? True                                                    
            ;set ContinuouslyPoorHarvestYear 2                  
          ]
          [
            ;; 5th year with good harvest (good1, 5th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_5th? True                                   
              ;set ContinuouslySameHarvestYear 1                                                                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_3rd? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_3 (CountDownExpansion1_3 - 1)
        if CountDownExpansion1_3 = 0
        [
          ;; 5th year with good harvest (good2, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_3rd? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation             
          ]
          [
            ;; 5th year with poor harvest (poor1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_6th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_6th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                            
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_2nd? = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_2 (CountDownMovement2_2 - 1)
        if CountDownMovement2_2 = 0 
        [                     
          ;; 5th year with poor harvest (poor3, 2nd) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                                                                            
          ]
          [
            ;; 5th year with good harvest (good1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_6th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                
          ]
          [
            ;; 5th year with good harvest (good1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_6th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_2years_2nd? = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_2 (CountDownExpansion2_2 - 1)
        if CountDownExpansion2_2 = 0
        [
          ;; 5th year with good harvest (good3, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_2nd? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation             
          ]
          [
            ;; 5th year with poor harvest (poor1, 7th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_7th? True                                                    
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_7th? True                                                    
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                           
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_4th? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_3 (CountDownMovement1_3 - 1)
        if CountDownMovement1_3 = 0
        [                     
          ;; 5th year with poor harvest (poor2, 4th)   
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_4th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;; 5th year with good harvest (good1, 7th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_7th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_4th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2               
          ]
          [
            ;; 5th year with good harvest (good1, 7th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_7th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_4th? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_4 (CountDownExpansion1_4 - 1)
        if CountDownExpansion1_4 = 0
        [
          ;; 5th year with good harvest (good2, 4th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_4th? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation             
          ]
          [
            ;; 5th year with poor harvest (poor1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_8th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_8th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                               
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_3years_1st? = True
      [
        set ContinuouslyPoorHarvestYear 3
        set CountDownMovement3_1 (CountDownMovement3_1 - 1)
        if CountDownMovement3_1 = 0
        [                   
          ;; 5th year with poor harvest (poor4, 1st) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 4                                                                            
          ]
          [
            ;; 5th year with good harvest (good1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_8th? True                                   
              ;set ContinuouslySameHarvestYear 1                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ] 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_1st? True                                                     
            ;set ContinuouslyPoorHarvestYear 4                
          ]
          [
            ;; 5th year with good harvest (good1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_8th? True                                   
              ;set ContinuouslySameHarvestYear 1                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
;;6th year
      if ContinuouslySameHarvestYearProcedure_5years_1st? = True
      [
        set ContinuouslySameHarvestYear 5
        set CountDownExpansion5_1 (CountDownExpansion5_1 - 1)
        if CountDownExpansion5_1 = 0
        [
          ;;6th with good harvest (good6, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_6years_1st? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 6                                                            ;; count the 3rd time of same good harvest situation             
          ]
          [
            ;;6th with poor harvest (poor1, 9th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_9th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                        
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_9th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                                
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_5th? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_5 (CountDownMovement1_5 - 1)
        if CountDownMovement1_5 = 0
        [                    
          ;;6th with poor harvest (poor2, 5th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_5th? True                                                    
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;;6th with good harvest (good1, 9th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_9th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_5th? True                                                    
            ;set ContinuouslyPoorHarvestYear 2               
          ]
          [
            ;;6th with good harvest (good1, 9th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_9th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_5th? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_5 (CountDownExpansion1_5 - 1)
        if CountDownExpansion1_5 = 0
        [
          ;;6th with good harvest (good2, 5th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_5th? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation            
          ]
          [
            ;;6th with poor harvest (poor1, 10th)  
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_10th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_10th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                              
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_3rd? = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_3 (CountDownMovement2_3 - 1)
        if CountDownMovement2_3 = 0
        [                    
          ;;6th with poor harvest (poor3, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_3rd? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                                                                            
          ]
          [
            ;;6th with good harvest (good1, 10th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_10th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_3rd? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                   
          ]
          [
            ;;6th with good harvest (good1, 10th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_10th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_2years_3rd? = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_3 (CountDownExpansion2_3 - 1)
        if CountDownExpansion2_3 = 0
        [
          ;;6th with good harvest (good3, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_3rd? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation             
          ]
          [
            ;;6th with poor harvest (poor1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_11th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_11th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                              
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_6th? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_6 (CountDownMovement1_6 - 1)
        if CountDownMovement1_6 = 0
        [                  
          ;;6th with poor harvest (poor2, 6th) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_6th? True                                                    
            ;set ContinuouslyPoorHarvestYear 2                                                                           
          ]
          [
            ;;6th with good harvest (good1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_11th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_6th? True                                                    
            ;set ContinuouslyPoorHarvestYear 2                 
          ]
          [
            ;;6th with good harvest (good1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_11th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]                
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_6th? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_6 (CountDownExpansion1_6 - 1)
        if CountDownExpansion1_6 = 0
        [
          ;;6th with good harvest (good2, 6th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_6th? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation              
          ]
          [
            ;;6th with poor harvest (poor1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_12th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                        
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_12th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                                
        ]
      ]      
      if ContinuouslyPoorHarvestYearProcedure_3years_2nd? = True
      [
        set ContinuouslyPoorHarvestYear 3
        set CountDownMovement3_2 (CountDownMovement3_2 - 1)
        if CountDownMovement3_2 = 0
        [                     
          ;;6th with poor harvest (poor4, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 4                                                                            
          ]
          [
            ;;6th with good harvest (good1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_12th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                         
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_2nd? True                                                     
            ;set ContinuouslyPoorHarvestYear 4                
          ]
          [
            ;;6th with good harvest (good1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_12th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                         
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]                
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_3years_2nd? = True
      [
        set ContinuouslySameHarvestYear 3
        set CountDownExpansion3_2 (CountDownExpansion3_2 - 1)
        if CountDownExpansion3_2 = 0
        [
          ;;6th with good harvest (good4, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_4years_2nd? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 4                                                            ;; count the 3rd time of same good harvest situation            
          ]
          [
            ;;6th with poor harvest (poor1, 13th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_13th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_13th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                              
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_7th? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_7 (CountDownMovement1_7 - 1)
        if CountDownMovement1_7 = 0
        [                    
          ;;6th with poor harvest (poor2, 7th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_7th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;;6th with good harvest (good1, 13th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_13th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_7th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                
          ]
          [
            ;;6th with good harvest (good1, 13th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_13th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_7th? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_7 (CountDownExpansion1_7 - 1)
        if CountDownExpansion1_7 = 0
        [
          ;;6th with good harvest (good2, 7th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_7th? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation            
          ]
          [
            ;;6th with poor harvest (poor1, 14th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_14th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_14th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                               
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_4th? = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_4 (CountDownMovement2_4 - 1)
        if CountDownMovement2_4 = 0
        [                    
          ;;6th with poor harvest (poor3, 4th) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_4th? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                                                                           
          ]
          [
            ;;6th with good harvest (good1, 14th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_14th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_4th? True                                                     
            ;set ContinuouslyPoorHarvestYear 3                 
          ]
          [
            ;;6th with good harvest (good1, 14th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_14th? True                                    
              ;set ContinuouslySameHarvestYear 1                                                                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_2years_4th? = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_4 (CountDownExpansion2_4 - 1)
        if CountDownExpansion2_4 = 0 
        [
          ;;6th with good harvest (good3, 4th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_4th? True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation            
          ]
          [
            ;;6th with poor harvest (poor1, 15th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_15th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_15th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                              
        ]
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_8th? = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_8 (CountDownMovement1_8 - 1)
        if CountDownMovement1_8 = 0
        [                        
          ;;6th with poor harvest (poor2, 8th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_8th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                            
          ]
          [
            ;;6th with good harvest (good1, 15th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_15th? True                                  
              ;set ContinuouslySameHarvestYear 1                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_8th? True                                                     
            ;set ContinuouslyPoorHarvestYear 2                  
          ]
          [
            ;;6th with good harvest (good1, 15th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_15th? True                                  
              ;set ContinuouslySameHarvestYear 1                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_8th? = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_8 (CountDownExpansion1_8 - 1)
        if CountDownExpansion1_8 = 0
        [
          ;;6th with good harvest (good2, 8th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_8th? True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation               
          ]
          [
            ;;6th with poor harvest (poor1, 16th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_16th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_16th? True                                                     
              ;set ContinuouslyPoorHarvestYear 1              
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                             
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_4years_1st? = True  
      [
        set ContinuouslyPoorHarvestYear 4
        set CountDownMovement4_1 (CountDownMovement4_1 - 1)
        if CountDownMovement4_1 = 0
        [                    
          ;;6th with poor harvest (poor5, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_5years_1st? True                                                    
            ;set ContinuouslyPoorHarvestYear 5                                                                           
          ]
          [
            ;;6th with good harvest (good1, 16th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_16th? True                                  
              ;set ContinuouslySameHarvestYear 1                                                               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_5years_1st? True                                                    
            ;set ContinuouslyPoorHarvestYear 5                   
          ]
          [
            ;;6th with good harvest (good1, 16th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_16th? True                                  
              ;set ContinuouslySameHarvestYear 1                                                               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]
      ]

;;start with poor harvest 
      if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False                                                                ;; before the 1st good harvest year
      [
;;1st year
        ;;1st year start with poor harvest (poor1, 1st)
        if NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
        [
          set ContinuouslyPoorHarvestYearProcedure_1year_1st?p True                                                     ;; the 1st downstream farmers have the poor harvest
        ]
;        if NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
;        [
;          set ContinuouslyPoorHarvestYearProcedure_1year_1st?p True                                                     ;; the 1st downstream farmers have the poor harvest
;          set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation              
;        ]      
      ]
;;2nd year
      if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = True      
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_1p (CountDownMovement1_1p - 1)
        if CountDownMovement1_1p = 0
        [                    
          ;; 2nd year with poor harvest (poor2, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_1st?p True                                                                                                                             
          ]
          [
            ;; 2nd year with good harvest (good1, 1st) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st?p True                                                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_1st?p True                                                                
          ]
          [
            ;; 2nd year with good harvest (good1, 1st) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st?p True                                                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
;;3rd year
      if ContinuouslySameHarvestYearProcedure_1year_1st?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_1p (CountDownExpansion1_1p - 1)                                  ;; CountDownExpansion1 is 365, and it decreases till 0 and the ohter comparison between farmers happens
        if CountDownExpansion1_1p = 0
        [
          ;; 3rd year with good harvest (good2, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_1st?p True                                         ;; the 1st time all farmers have the same good harvest          
          ]
          [
            ;; 3rd year with poor harvest (poor1, 2nd) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_2nd?p True                                                                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_2nd?p True                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                
            ]             
          ]                                
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_1st?p = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_1p (CountDownMovement2_1p - 1)
        if CountDownMovement2_1p = 0
        [                    
          ;; 2nd year with poor harvest (poor3, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_1st?p True                                                                                                                               
          ]
          [
            ;; 2nd year with good harvest (good1, 2nd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_2nd?p True                                                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_1st?p True                                                     
            ;set ContinuouslyPoorHarvestYear 3                
          ]
          [
            ;; 2nd year with good harvest (good1, 2nd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_2nd?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]        
      ]
;; 4th year
      if ContinuouslySameHarvestYearProcedure_2years_1st?p = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion1_2p (CountDownExpansion1_2p - 1)
        if CountDownExpansion1_2p = 0
        [
          ;; 4th year with good harvest (good3, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_1st?p True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation              
          ]
          [
            ;; 4th year with poor harvest (poor1, 3rd) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_3rd?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_3rd?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                                 
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_2nd?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_2p (CountDownMovement1_2p - 1)
        if CountDownMovement1_2p = 0
        [                   
          ;; 4th year with poor harvest (poor2, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_2nd?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                           
          ]
          [
            ;; 4th year with good harvest (good1, 3rd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_3rd?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_2nd?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2               
          ]
          [
            ;; 4th year with good harvest (good1, 3rd)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_3rd?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_1year_2nd?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_2p (CountDownExpansion1_2p - 1)
        if CountDownExpansion1_2p = 0
        [
          ;; 4th year with good harvest (good2, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_2nd?p True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation             
          ]
          [
            ;; 4th year with poor harvest (poor1, 4th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_4th?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1                                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_4th?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]                              
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_3years_1st?p = True
      [
        set ContinuouslyPoorHarvestYear 3  
        set CountDownMovement3_1p (CountDownMovement3_1p - 1)
        if CountDownMovement3_1p = 0
        [                     
          ;; 4th year with poor harvest (poor4, 1st)    
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_1st?p True                                                    
            ;set ContinuouslyPoorHarvestYear 4                                                                         
          ]
          [
            ;; 4th year with good harvest (good1, 4th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_4th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_1st?p True                                                    
            ;set ContinuouslyPoorHarvestYear 4               
          ]
          [
            ;; 4th year with good harvest (good1, 4th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_4th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]                
          ]           
        ]        
      ]
;; 5th year
      if ContinuouslySameHarvestYearProcedure_3years_1st?p = True
      [
        set ContinuouslySameHarvestYear 3
        set CountDownExpansion3_1p (CountDownExpansion3_1p - 1)
        if CountDownExpansion3_1p = 0 
        [     
          ;; 5th year with good harvest (good4, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_4years_1st?p True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 4                                                            ;; count the 3rd time of same good harvest situation             
          ]
          [
            ;; 5th year with poor harvest (poor1, 5th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_5th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                    
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_5th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]                                
        ]   
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_3rd?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_3p (CountDownMovement1_3p - 1)
        if CountDownMovement1_3p = 0
        [                    
          ;; 5th year with poor harvest (poor2, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_3rd?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                           
          ]
          [
            ;; 5th year with good harvest (good1, 5th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_5th?p True                                   
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_3rd?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                
          ]
          [
            ;; 5th year with good harvest (good1, 5th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_5th?p True                                   
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]         
      ]      
      if ContinuouslySameHarvestYearProcedure_1year_3rd?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_3p (CountDownExpansion1_3p - 1)
        if CountDownExpansion1_3p = 0
        [  
          ;; 5th year with good harvest (good2, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_3rd?p True                                         
            ;set ContinuouslySameHarvestYear 2                                                                   
          ]
          [
            ;; 5th year with poor harvest (poor1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_6th?p True                                                   
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_6th?p True                                                   
              ;set ContinuouslyPoorHarvestYear 1                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]           
        ]          
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_2nd?p = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_2p (CountDownMovement2_2p - 1)
        if CountDownMovement2_2p = 0 
        [                      
          ;; 5th year with poor harvest (poor3, 2nd) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_2nd?p True                                                    
            ;set ContinuouslyPoorHarvestYear 3                                                                           
          ]
          [
            ;; 5th year with good harvest (good1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_6th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_2nd?p True                                                    
            ;set ContinuouslyPoorHarvestYear 3               
          ]
          [
            ;; 5th year with good harvest (good1, 6th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_6th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]            
      ]
      if ContinuouslySameHarvestYearProcedure_2years_2nd?p = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_2p (CountDownExpansion2_2p - 1)
        if CountDownExpansion2_2p = 0
        [  
          ;; 5th year with good harvest (good3, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_2nd?p True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation              
          ]
          [
            ;; 5th year with poor harvest (poor1, 7th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_7th?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1                                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_7th?p True                                                  
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]           
        ]              
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_4th?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_3p (CountDownMovement1_3p - 1)
        if CountDownMovement1_3p = 0
        [  
          ;; 5th year with poor harvest (poor2, 4th)  
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_4th?p True                                                  
            ;set ContinuouslyPoorHarvestYear 2                                                                           
          ]
          [
            ;; 5th year with good harvest (good1, 7th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_7th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_4th?p True                                                  
            ;set ContinuouslyPoorHarvestYear 2                 
          ]
          [
            ;; 5th year with good harvest (good1, 7th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_7th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]            
      ]
      if ContinuouslySameHarvestYearProcedure_1year_4th?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_4p (CountDownExpansion1_4p - 1)
        if CountDownExpansion1_4p = 0
        [
          ;; 5th year with good harvest (good2, 4th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_4th?p True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation             
          ]
          [
            ;; 5th year with poor harvest (poor1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_8th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_8th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                 
            ]             
          ]           
        ]                    
      ]
      if ContinuouslyPoorHarvestYearProcedure_4years_1st?p = True 
      [
        set ContinuouslyPoorHarvestYear 4
        set CountDownMovement4_1p (CountDownMovement4_1p - 1)
        if CountDownMovement4_1p = 0
        [
          ;; 5th year with poor harvest (poor5, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_5years_1st?p True                                                     
            ;set ContinuouslyPoorHarvestYear 5                                                                            
          ]
          [
            ;; 5th year with good harvest (good1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_8th?p True                                
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_5years_1st?p True                                                     
            ;set ContinuouslyPoorHarvestYear 5                 
          ]
          [
            ;; 5th year with good harvest (good1, 8th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_8th?p True                                
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]                      
      ]
;;6th year
      if ContinuouslySameHarvestYearProcedure_4years_1st?p = True
      [
        set ContinuouslySameHarvestYear 4
        set CountDownExpansion4_1p (CountDownExpansion4_1p - 1)
        if CountDownExpansion4_1p = 0
        [
          ;; 6th year with good harvest (good5, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_5years_1st?p True                                    
            ;set ContinuouslySameHarvestYear 5                                                                      
          ]
          [
            ;; 6th year with poor harvest (poor1, 9th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_9th?p True                                                    
              ;set ContinuouslyPoorHarvestYear 1                                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_9th?p True                                                    
              ;set ContinuouslyPoorHarvestYear 1               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]                
            ]             
          ]            
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_5th?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_5p (CountDownMovement1_5p - 1)
        if CountDownMovement1_5p = 0
        [
          ;; 6th year with poor harvest (poor2, 5th) 
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_5th?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                           
          ]
          [
            ;; 6th year with good harvest (good1, 9th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_9th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_5th?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                
          ]
          [
            ;; 6th year with good harvest (good1, 9th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_9th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                     
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_1year_5th?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_5p (CountDownExpansion1_5p - 1)
        if CountDownExpansion1_5p = 0
        [
          ;; 6th year with good harvest (good2, 5th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_5th?p True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation            
          ]
          [
            ;; 6th year with poor harvest (poor1, 10th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_10th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_10th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                  
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]           
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_3rd?p = True 
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_3p (CountDownMovement2_3p - 1)
        if CountDownMovement2_3p = 0
        [  
          ;; 6th year with poor harvest (poor3, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_3rd?p True                                                   
            ;set ContinuouslyPoorHarvestYear 3                                                                     
          ]
          [
            ;; 6th year with good harvest (good1, 10th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_10th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_3rd?p True                                                   
            ;set ContinuouslyPoorHarvestYear 3                
          ]
          [
            ;; 6th year with good harvest (good1, 10th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_10th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                       
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_2years_3rd?p = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_3p (CountDownExpansion2_3p - 1)
        if CountDownExpansion2_3p = 0
        [
          ;; 6th year with good harvest (good3, 3rd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_3rd?p True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 3                                                            ;; count the 3rd time of same good harvest situation              
          ]
          [
            ;; 6th year with poor harvest (poor1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_11th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_11th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation               
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]          
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_6th?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_6p (CountDownMovement1_6p - 1)
        if CountDownMovement1_6p = 0
        [
          ;; 6th year with poor harvest (poor2, 6th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_6th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 2                                                                            ;; count the 1st time of poor harvest situation
          ]
          [
            ;; 6th year with good harvest (good1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_11th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation           
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_6th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 2                                                                            ;; count the 1st time of poor harvest situation              
          ]
          [
            ;; 6th year with good harvest (good1, 11th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_11th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation           
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_1year_6th?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_6p (CountDownExpansion1_6p - 1)
        if CountDownExpansion1_6p = 0
        [
          ;; 6th year with good harvest (good2, 6th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_6th?p True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation             
          ]
          [
            ;; 6th year with poor harvest (poor1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_12th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_12th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]          
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_3years_2nd?p = True
      [
        set ContinuouslyPoorHarvestYear 3
        set CountDownMovement3_2p (CountDownMovement3_2p - 1)
        if CountDownMovement3_2p = 0
        [
          ;; 6th year with poor harvest (poor4, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_2nd?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 4                                                                            ;; count the 1st time of poor harvest situation
          ]
          [
            ;; 6th year with good harvest (good1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_12th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation           
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_4years_2nd?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 4                                                                            ;; count the 1st time of poor harvest situation              
          ]
          [
            ;; 6th year with good harvest (good1, 12th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_12th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation           
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_3years_2nd?p = True
      [
        set ContinuouslySameHarvestYear 3
        set CountDownExpansion3_2p (CountDownExpansion3_2p - 1)
        if CountDownExpansion3_2p = 0
        [
          ;; 6th year with good harvest (good4, 2nd)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_4years_2nd?p True                                    ;; the 3st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 4                                                            ;; count the 3rd time of same good harvest situation            
          ]
          [
            ;; 6th year with poor harvest (poor1, 13th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_13th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_13th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation              
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]               
            ]             
          ]          
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_7th?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_7p (CountDownMovement1_7p - 1)
        if CountDownMovement1_7p = 0
        [
          ;; 6th year with poor harvest (poor2, 7th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_7th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 2                                                                            ;; count the 1st time of poor harvest situation
          ]
          [
            ;; 6th year with good harvest (good1, 13th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_13th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation             
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_7th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 2                                                                            ;; count the 1st time of poor harvest situation              
          ]
          [
            ;; 6th year with good harvest (good1, 13th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_13th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation             
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_1year_7th?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_7p (CountDownExpansion1_7p - 1)
        if CountDownExpansion1_7p = 0
        [
          ;; 6th year with good harvest (good2, 7th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_7th?p True                                         ;; the 1st time all farmers have the same good harvest
            ;set ContinuouslySameHarvestYear 2                                                            ;; count the 1st time of same good harvest situation              
          ]
          [
            ;; 6th year with poor harvest (poor1, 14th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_14th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_14th?p True                                                     ;; the 1st downstream farmers have the poor harvest
              ;set ContinuouslyPoorHarvestYear 1                                                                            ;; count the 1st time of poor harvest situation              
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]          
        ]        
      ]
      if ContinuouslyPoorHarvestYearProcedure_2years_4th?p = True
      [
        set ContinuouslyPoorHarvestYear 2
        set CountDownMovement2_4p (CountDownMovement2_4p - 1)
        if CountDownMovement2_4p = 0
        [
          ;; 6th year with poor harvest (poor3, 4th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_4th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 3                                                                            ;; count the 1st time of poor harvest situation
          ]
          [
            ;; 6th year with good harvest (good1, 14th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_14th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_3years_4th?p True                                                     ;; the 1st downstream farmers have the poor harvest
            ;set ContinuouslyPoorHarvestYear 3                                                                            ;; count the 1st time of poor harvest situation              
          ]
          [
            ;; 6th year with good harvest (good1, 14th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_14th?p True                                    ;; the 3st time all farmers have the same good harvest
              ;set ContinuouslySameHarvestYear 1                                                            ;; count the 3rd time of same good harvest situation            
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]               
          ]           
        ]        
      ]
      if ContinuouslySameHarvestYearProcedure_2years_4th?p = True
      [
        set ContinuouslySameHarvestYear 2
        set CountDownExpansion2_4p (CountDownExpansion2_4p - 1)
        if CountDownExpansion2_4p = 0 
        [
          ;; 6th year with good harvest (good3, 4th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_3years_4th?p True                                   
            ;set ContinuouslySameHarvestYear 3                                                                        
          ]
          [
            ;; 6th year with poor harvest (poor1, 15th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_15th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_15th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]          
        ]          
      ]
      if ContinuouslyPoorHarvestYearProcedure_1year_8th?p = True
      [
        set ContinuouslyPoorHarvestYear 1
        set CountDownMovement1_8p (CountDownMovement1_8p - 1)
        if CountDownMovement1_8p = 0
        [
          ;; 6th year with poor harvest (poor2, 8th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_8th?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2                                                                       
          ]
          [
            ;; 6th year with good harvest (good1, 15th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_15th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_2years_8th?p True                                                     
            ;set ContinuouslyPoorHarvestYear 2               
          ]
          [
            ;; 6th year with good harvest (good1, 15th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_15th?p True                                    
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]              
          ]           
        ]
      ]
      if ContinuouslySameHarvestYearProcedure_1year_8th?p = True
      [
        set ContinuouslySameHarvestYear 1
        set CountDownExpansion1_8p (CountDownExpansion1_8p - 1)
        if CountDownExpansion1_8p = 0
        [
          ;; 6th year with good harvest (good2, 8th)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
          [
            set ContinuouslySameHarvestYearProcedure_2years_8th?p True                                        
            ;set ContinuouslySameHarvestYear 2                                                                      
          ]
          [
            ;; 6th year with poor harvest (poor1, 16th) 
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_16th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                                                                                   
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
            [
              set ContinuouslyPoorHarvestYearProcedure_1year_16th?p True                                                     
              ;set ContinuouslyPoorHarvestYear 1                 
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]             
          ]           
        ]              
      ]
      if ContinuouslyPoorHarvestYearProcedure_5years_1st?p = True
      [
        set ContinuouslyPoorHarvestYear 5
        set CountDownMovement5_1p (CountDownMovement5_1p - 1)
        if CountDownMovement5_1p = 0 
        [
          ;; 6th year with poor harvest (poor6, 1st)
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 < 3 and NumberofHarvestFieldsF9 < 3 and NumberofHarvestFieldsF10 < 3
          [
            set ContinuouslyPoorHarvestYearProcedure_6years_1st?p True                                                     
            ;set ContinuouslyPoorHarvestYear 6                                                                            
          ]
          [
            ;; 6th year with good harvest (good1, 16th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_16th?p True                                  
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]
          ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and one-of DownstreamfarmersHarvestFieldsList = 0
          [
            set ContinuouslyPoorHarvestYearProcedure_6years_1st?p True                                                     
            ;set ContinuouslyPoorHarvestYear 6                                                                    
          ]
          [
            ;; 6th year with good harvest (good1, 16th)
            ifelse NumberofHarvestFieldsF1 = 5 and NumberofHarvestFieldsF2 = 5 and NumberofHarvestFieldsF3 = 5 and NumberofHarvestFieldsF8 >= 3 and NumberofHarvestFieldsF9 >= 3 and NumberofHarvestFieldsF10 >= 3
            [
              set ContinuouslySameHarvestYearProcedure_1year_16th?p True                                  
              ;set ContinuouslySameHarvestYear 1                                                                      
            ]
            [
              set ContinuouslySameHarvestYearProcedure_1year_1st? False
              set ContinuouslyPoorHarvestYearProcedure_1year_1st?p False
              if ContinuouslySameHarvestYearProcedure_1year_1st? = False
              [
                set ContinuouslySameHarvestYear 0
                set CountDownExpansion1_1 (ComparisonCountDownForCanalExpansion + 1)                                     ;; use to record the continuously same good harvest year with 1 year, appear at the 1st time
              ]
              if ContinuouslyPoorHarvestYearProcedure_1year_1st?p = False
              [
                set ContinuouslyPoorHarvestYear 0
                set CountDownExpansion1_1p (ComparisonCountDownForCanalExpansion + 1)
              ]              
            ]            
          ]           
        ]
      ]      
    ]
    
                
;;canal expansion indicator    
    if CSHY = ContinuouslySameHarvestYear
    [
      SecondaryCanal_Expansion
      set ContinuouslySameHarvestYearProcedure_5years_1st? False
    ]
    if ContinuouslySameHarvestYearProcedure_5years_1st? = False
    [
      set ContinuouslySameHarvestYear 0
    ]
    
    if CPHY = ContinuouslyPoorHarvestYear
    [
      SecondaryCanal_Movement
      set ContinuouslyPoorHarvestYearProcedure_5years_1st?p False
    ]
    if ContinuouslyPoorHarvestYearProcedure_5years_1st?p = False
    [
      set ContinuouslyPoorHarvestYear 0
    ]
  ]
end

